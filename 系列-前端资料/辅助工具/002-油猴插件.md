002 - 油猴插件
===

> Create by **jsliang** on **2021-12-23 08:57:06**  
> Recently revised in **2021-12-29 22:21:15**

作为一枚喜爱折腾的咸鱼，看到一些新产品发布，难免先体验一番。

但是，如果这个产品不是很满足你的想法，然后你又不想走反馈流程，毕竟要等几个月才能体验新功能。

所以，这时候肯定想方设法 DIY 它！

## 一 既定目标

本次操刀的是「金山文档」的新产品「文档」

* [x] 支持模板搜索功能
* [x] 「做不了，技术限制」支持导入自定义模板
* [ ] 插入自定义 emoji
* [ ] 右键搜索功能
  * [ ] 页内搜索
  * [ ] 页外搜索
* [x] 字数统计
* [ ] 皮肤
* [ ] 自定义视频（不局限 哔哩哔哩）

## 二 实现情况

油猴脚本（Tampermonkey）是一个非常流行的浏览器扩展，它可以运行由广大社区编写的扩展脚本，来实现各式各样的功能，常见的去广告、修改样式文件、甚至是下载视频.

> 它可能需要使用一丁点的小手段，才能下载插件和访问官网，当然，如果找不到好的方式，你可以直接 call **jsliang**，让他给你推荐个小工具

* 下载：[Chrome 拓展工具：Tampermonkey](https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo?hl=zh)
* 使用说明：[Tampermonkey 首页](https://www.tampermonkey.net/index.php?version=4.13&ext=dhdg&updated=true)

当然，有些小伙伴想偷懒，直接看从安装到建立第一个脚本，可以看下面 GIF：

![图](./img/002-01.gif)

## 四 疑难解惑

### 4.1 为什么脚本被运行了多次？

* 问：为什么脚本被运行了多次？
* 答：可参考：

```
https://stackoverflow.com/questions/59795141/userscript-should-run-once-not-multiple-times

your script could be loading for each frame in the page.
add // @noframes to prevent this.

// ==UserScript==
// @name         Test
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  try to take over the world!
// @author       You
// @match        https://myanimelist.net/*
// @require http://code.jquery.com/jquery-3.4.1.slim.min.js
// @grant        none
// @noframes
// ==/UserScript==
```

意思是这个页面，如果加载了多次 `iframe`，那么在每个 `iframe` 中都会执行，所以需要禁止掉 `iframe`，故添加 `// @noframes` 即可！

### 4.2 开发过程的 Icon 这些资源怎么获取？

在编写插件的过程中，难免用到一些网上资源，例如右下角的刷新按钮，所以我将这些资源罗列起来了，小伙伴们按需领取：

* Icon 图标获取：https://www.flaticon.com/free-icons/refresh
* 图片转 Base64 编码：https://c.runoob.com/front-end/59/

## 三 参考文献

* [【SegmentFault】techstay - 油猴脚本编写教程](https://segmentfault.com/a/1190000021654926)
* [【张鑫旭】JS 复制文字到剪切板的极简实现及扩展](https://www.zhangxinxu.com/wordpress/2021/10/js-copy-paste-clipboard/)
* [【知乎】前端天宇 - 9 个很棒的 CSS 边框技巧](https://zhuanlan.zhihu.com/p/144775015)

---

> jsliang 的文档库由 [梁峻荣](https://github.com/LiangJunrong) 采用 [知识共享 署名-非商业性使用-相同方式共享 4.0 国际 许可协议](http://creativecommons.org/licenses/by-nc-sa/4.0/) 进行许可。<br/>基于 [https://github.com/LiangJunrong/document-library](https://github.com/LiangJunrong/document-library) 上的作品创作。<br/>本许可协议授权之外的使用权限可以从 [https://creativecommons.org/licenses/by-nc-sa/2.5/cn/](https://creativecommons.org/licenses/by-nc-sa/2.5/cn/) 处获得。
